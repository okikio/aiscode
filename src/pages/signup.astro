---
import AuthLayout from '~/layouts/Auth.astro';

const user = Astro.locals?.user;
if (user) {
	return Astro.redirect("/");
}

export const prerender = false;
const csrfToken = 'your-csrf-token'; // Replace with actual token fetching logic if needed
---
<AuthLayout title="SignUp">
  <div class="login-sec">
    <div class="col-lg-5 col-11 m-auto">
      <div class="text-center mb-3">
        <div class="header-ads mobile-ads">
          <img src="/front/images/ad-left.png" alt="Ad Left" class="img-fluid" />
        </div>
      </div>
      <div class="login-from">
        <div class="form-header mb-lg-3 mb-2">
          <h2 class="f-15 text-uppercase text-white text-center mb-0 fw-700 montserrat-font">
            Donâ€™t have an account yet?
          </h2>
        </div>
        <form method="post" id="registerForm" name="registerForm" action="/api/signup">
          <input type="hidden" name="_token" value={csrfToken} />
          <div class="row g-2 align-items-center">
            <!-- <div class="col-md-6 form-group">
              <input type="text" class="form-control" id="first_name" placeholder="First Name" name="first_name" required />
            </div>
            <div class="col-md-6 form-group">
              <input type="text" class="form-control" id="last_name" placeholder="Last Name" name="last_name" required />
            </div> -->
            <div class="col-md-12 form-group">
              <input type="text" class="form-control" id="username" placeholder="User Name" name="username" required />
            </div>
            <div class="col-md-12 form-group">
              <input type="email" class="form-control" id="email" placeholder="Enter Email" name="email" required />
            </div>
            <div class="col-md-6 form-group">
              <input type="password" class="form-control" id="password" placeholder="Enter Password" name="password" required />
            </div>
            <div class="col-md-6 form-group">
              <input type="password" class="form-control" id="confirm_password" placeholder="ReEnter Password" name="confirm_password" autocomplete="new-password" required />
            </div>
            <!-- <div class="col-md-12 form-group">
              <input type="text" class="form-control" id="phone_number" placeholder="Phone Number" name="phone_number" required />
            </div> -->
          </div>
          <!-- <div class="row mt-2 gx-2 gy-2">
            <p class="montserrat-font f-12 mb-1 text-uppercase text-white">Choose the date of birth</p>
            <div class="col-md-4 form-group">
              <select class="form-select" aria-label="Default select example" id="yearDropdownField" name="year">
              </select>
            </div>
            <div class="col-md-4">
              <select class="form-select" aria-label="Default select example" id="monthDropdownField" name="month">
              </select>
            </div>
            <div class="col-md-4">
              <select class="form-select" aria-label="Default select example" id="dateDropdownField" name="date">
              </select>
            </div>
            <p class="montserrat-font f-12 mt-1 mb-1 text-white">
              Please Note: You must be over 18 to create an account.
            </p>
          </div> -->
          <div class="mb-3 mt-1 text-center">
            <button class="gaming-btn btn btn-primary" type="submit">
              <span class="btn">Sign Up</span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="/front/js/jquery-validation/jquery.validate.min.js" is:inline></script>
  <script src="/front/js/jquery-validation/additional-methods.min.js" is:inline></script>
  <script>
    // Custom JavaScript for form validation
    $(document).ready(function () {
      $('#registerForm').validate({
        rules: {
          password: {
            required: true,
            minlength: 6
          },
          confirm_password: {
            required: true,
            equalTo: '#password'
          }
        },
        messages: {
          password: {
            required: 'Please enter a password',
            minlength: 'Your password must be at least 6 characters long'
          },
          confirm_password: {
            required: 'Please confirm your password',
            equalTo: 'Passwords do not match'
          }
        }
      });
    });

    // Populate date dropdowns
    // const yearDropdown = document.getElementById('yearDropdownField');
    // const monthDropdown = document.getElementById('monthDropdownField');
    // const dateDropdown = document.getElementById('dateDropdownField');

    // for (let year = new Date().getFullYear(); year >= 1900; year--) {
    //   let option = document.createElement('option');
    //   option.value = year;
    //   option.text = year;
    //   yearDropdown.add(option);
    // }

    // for (let month = 1; month <= 12; month++) {
    //   let option = document.createElement('option');
    //   option.value = month;
    //   option.text = month;
    //   monthDropdown.add(option);
    // }

    // for (let date = 1; date <= 31; date++) {
    //   let option = document.createElement('option');
    //   option.value = date;
    //   option.text = date;
    //   dateDropdown.add(option);
    // }

    // function onChangeYearAndMonth() {
    //   const selectedYear = parseInt(yearDropdown.value);
    //   const selectedMonth = parseInt(monthDropdown.value);
    //   const daysInMonth = new Date(selectedYear, selectedMonth, 0).getDate();
    //   dateDropdown.innerHTML = '';
    //   for (let date = 1; date <= daysInMonth; date++) {
    //     let option = document.createElement('option');
    //     option.value = date;
    //     option.text = date;
    //     dateDropdown.add(option);
    //   }
    // }

    // yearDropdown.addEventListener('change', onChangeYearAndMonth);
    // monthDropdown.addEventListener('change', onChangeYearAndMonth);
  </script>
</AuthLayout>
